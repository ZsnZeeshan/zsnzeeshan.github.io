<!-- Disable Google Analytics w/o consent-->

<!-- {% if site.google_analytics %}
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', '{{ site.google_analytics }}', 'auto');
    ga('send', 'pageview');
  </script>
{% endif %} -->
<!-- Google Analytics with cookie consent -->

<div id="cookie-consent"
     style="position:fixed;bottom:0;left:0;right:0;
            background:#111;color:#fff;padding:12px;
            font-size:14px;z-index:9999;display:none;">
  This site uses Google Analytics to monitor traffic.
  <a href="/privacy.html" style="color:#9cf;"><br>Privacy policy</a>
  <button id="accept-cookies" style="margin-left:10px;">Accept</button>
</div>

<script>
(function () {
  const consent = localStorage.getItem("ga_consent");
  const banner = document.getElementById("cookie-consent");

  if (!consent) banner.style.display = "block";

  document.getElementById("accept-cookies").onclick = function () {
    localStorage.setItem("ga_consent", "granted");
    banner.style.display = "none";
    loadGA();
  };

  if (consent === "granted") loadGA();

  function loadGA() {
    if (window.gaLoaded) return;
    window.gaLoaded = true;

    const s = document.createElement("script");
    s.src = "https://www.googletagmanager.com/gtag/js?id=G-3T5JF88VB0";
    s.async = true;
    document.head.appendChild(s);

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag("js", new Date());

    gtag("config", "G-3T5JF88VB0", {
      anonymize_ip: true
    });
  }
})();
</script>
<!-- End Google Analytics with cookie consent -->